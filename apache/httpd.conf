ServerName localhost
Listen 80

# ===== MPM (OBRIGATÓRIO) =====
LoadModule mpm_event_module modules/mod_mpm_event.so

# ===== MÓDULOS BÁSICOS =====
LoadModule authn_core_module modules/mod_authn_core.so
LoadModule authz_core_module modules/mod_authz_core.so
LoadModule unixd_module modules/mod_unixd.so
LoadModule dir_module modules/mod_dir.so
LoadModule mime_module modules/mod_mime.so
LoadModule log_config_module modules/mod_log_config.so

# ===== PROXY =====
LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_http_module modules/mod_proxy_http.so
LoadModule headers_module modules/mod_headers.so

# ===== STATUS =====
LoadModule status_module modules/mod_status.so
ExtendedStatus On

<Location /server-status>
    SetHandler server-status
    Require all granted
</Location>

# ===== LOGS (Docker-friendly) =====
ErrorLog /proc/self/fd/2
CustomLog /proc/self/fd/1 combined

LogFormat "[STRUTS2] %h %l %u %t \"%r\" %>s %b" struts_format

<VirtualHost *:80>
    ServerName localhost

    CustomLog /proc/self/fd/1 struts_format

    ProxyPreserveHost On

    ProxyPass /server-status !

    ProxyPass / http://tomcat:8080/
    ProxyPassReverse / http://tomcat:8080/
</VirtualHost>

